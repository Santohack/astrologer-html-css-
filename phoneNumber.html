<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <script src="script.js"></script>
    <title>Astroline</title>
  </head>
  <body>
    <div class="style_wrapper__hdxt9 progressbar-enter-done">
      <div class="style_progress__ym3Ja">
        <div class="style_container__2SlEL">
          <button type="button" onclick="redirectToemailPagethpagePage()">
            <svg
              width="21"
              height="13"
              xmlns="http://www.w3.org/2000/svg"
              class="style_icon__hV1Jz"
            >
              <path
                d="M19.945 5.452H3.61l3.7-3.66A1.044 1.044 0 0 0 7.313.308 1.06 1.06 0 0 0 5.82.305L.311 5.757a1.045 1.045 0 0 0-.002 1.485l5.512 5.453a1.06 1.06 0 0 0 1.492-.004c.41-.41.409-1.074-.004-1.482l-3.7-3.66h16.336c.583 0 1.055-.47 1.055-1.049s-.472-1.048-1.055-1.048z"
              ></path>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- progressbar -->
    <div class="style_birth__f+7Ci" style="height: 660px">
      <h1
        class="style_title_h1__drby6 style_birth__title__e9yDR"
        style="
          font-size: 38px;
          line-height: 42px;
          color: rgb(242, 230, 196);
          text-align: center;
          font-weight: 700;
          font-family: Philosopher;
        "
      >
        Enter your Number
      </h1>
      <p
        class="style_text__5JYBx style_birth__text__ReUao"
        style="
          font-size: 15px;
          line-height: 25px;
          color: rgb(208, 184, 148);
          margin-top: 14.2939px;
          text-align: center;
          font-weight: 400;
          padding-right: 10.4667px;
          padding-left: 10.4667px;
          font-family: 'Open Sans';
        "
      >
        We need it to look up your account.
      </p>
      <div class="style_form__TG9rn">
        <div class="style_wrapper__zL8LD style_wrap__JK7KD">
          <input
            class="style_input__CzcOK style_input__cz8gI style_form__picker__mxQ0d border-email"
            placeholder="type your Phone number"
            value=""
            id="phonenumber"
          />
        </div>
        <button
          type="submit"
          class="style_button__ATdiY style_form__button__13Op5"
        >
          <div class="style_button__title__q-1y-"><span>Continue</span></div>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="38"
            height="33"
            viewBox="0 0 38 33"
            class="style_button__right-icon__3MH3Y"
          >
            <defs>
              <filter
                id="a"
                width="109.2%"
                height="152.7%"
                x="-4.6%"
                y="-24.5%"
                filterUnits="objectBoundingBox"
              >
                <feOffset
                  dy="1"
                  in="SourceAlpha"
                  result="shadowOffsetOuter1"
                ></feOffset>
                <feGaussianBlur
                  in="shadowOffsetOuter1"
                  result="shadowBlurOuter1"
                  stdDeviation="2"
                ></feGaussianBlur>
                <feColorMatrix
                  in="shadowBlurOuter1"
                  result="shadowMatrixOuter1"
                  values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"
                ></feColorMatrix>
                <feMerge>
                  <feMergeNode in="shadowMatrixOuter1"></feMergeNode>
                  <feMergeNode in="SourceGraphic"></feMergeNode>
                </feMerge>
              </filter>
            </defs>
            <g
              filter="url(#a)"
              transform="translate(-266 -11)"
              fill="#FFF"
              stroke="#FFF"
              stroke-width="0.5"
            >
              <path
                d="M288.5 20.2a.7.7 0 00-1 0c-.3.3-.3.8 0 1l5 5.5h-16.8c-.4 0-.7.4-.7.8s.3.8.7.8h16.9l-5.1 5.4c-.3.3-.3.8 0 1 .2.4.7.4 1 0l6.3-6.7c.3-.3.3-.7 0-1l-6.3-6.8z"
              ></path>
            </g>
          </svg>
        </button>
      </div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document
          .querySelector(".style_form__button__13Op5")
          .addEventListener("click", function () {
            var selectdplace = document.getElementById("phonenumber").value;

            console.log("Selected phonenumber:", selectdplace);

            var selectedValues = {
              phone: selectdplace,
            };
            var qaArray = [
              { question: "Enter your Number", answer: selectedValues },
            ];

            var selectedValuesJson = JSON.stringify(qaArray);

            localStorage.setItem("selectedphonenumber", selectedValuesJson);

            var keyname = [
            "selectedEmail",
              "selectedName",
              "selectedphonenumber",
            ];

            var dataName = keyname
              .map(function (key) {
                var storedData = localStorage.getItem(key);

                if (storedData) {
                  return JSON.parse(storedData)[0]; // Only push the first item (question and answer)
                } else {
                  console.log("No data found for key:", key);
                  return null;
                }
              })
              .filter(Boolean); // Filter out null values

            console.log("Data array :", dataName);
            function convertToURLParams(data) {
              var params = data.map(function (item) {
                var question = encodeURIComponent(item.question);
                var answerKey = Object.keys(item.answer)[0];
                var answerValue = encodeURIComponent(item.answer[answerKey]);
                return `${answerKey}=${answerValue}`;
              });
              return params.join("&");
            }

            // Create the URL parameters
            var urlParams = convertToURLParams(dataName);

            // Construct the final URL
            var finalURL = `http://domainX.com/?${urlParams}`;

            console.log("Final URL:", finalURL);

            var keysToRetrieve = [
              "selectedUrl",
              "selectedtime",
              "selectedyear",
              "selectedplace",
              "selectedStatus",
              "selectedGoals",
              "selectedElement",
              "selectedColors",
            ];

            var dataArray = keysToRetrieve
              .map(function (key) {
                var storedData = localStorage.getItem(key);

                if (storedData) {
                  return JSON.parse(storedData)[0]; // Only push the first item (question and answer)
                } else {
                  console.log("No data found for key:", key);
                  return null;
                }
              })
              .filter(Boolean); // Filter out null values

            console.log("Data array from local storage:", dataArray);
            function constructUrl(data) {
              var url = finalURL +"&qa=[";

              data.forEach(function (item, index) {
                var question = item.question;
                var answer = JSON.stringify(item.answer);

                url +=
                  '{"question":"' + question + '","answer":"' + answer + '"}';

                if (index < data.length - 1) {
                  url += ",";
                }
              });

              url += "]";

              return url;
            }

            // Example data array

            var finalUrlDomail = constructUrl(dataArray);
            console.log("Final URL:", finalUrlDomail);
             window.location.href = finalUrlDomail;
          });
      });
    </script>
  </body>
</html>
